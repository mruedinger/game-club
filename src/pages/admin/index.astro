---
import SiteHeader from "../../components/SiteHeader.astro";

export const prerender = false;
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Game Club | Admin</title>
	</head>
	<body>
		<SiteHeader>
			<Fragment slot="nav">
				<a href="/">Home</a>
				<a href="/admin">Admin</a>
			</Fragment>
			<Fragment slot="actions">
				<form action="/api/auth/logout" method="post">
					<button class="ghost" type="submit">Sign out</button>
				</form>
			</Fragment>
		</SiteHeader>

		<main class="admin-shell is-hidden">
			<section class="hero">
				<p class="eyebrow">Admin</p>
				<h1>Game Club control room</h1>
				<p class="muted">Manage members, content, and club operations.</p>
			</section>

			<section class="card">
				<div class="section-head">
					<h2>Members</h2>
					<p class="muted">View, add, edit, disable, or delete members.</p>
				</div>
				<div class="actions">
					<span class="chip">View</span>
					<span class="chip">Add</span>
					<span class="chip">Edit</span>
					<span class="chip">Disable</span>
					<span class="chip">Delete</span>
				</div>
				<p class="muted small">
					Member management tools will live here. For now this is a scaffold.
				</p>
			</section>
		</main>

		<script>
			const shell = document.querySelector(".admin-shell");

			fetch("/api/me")
				.then((response) => {
					if (response.status === 401) {
						window.location.href = "/api/auth/login";
						throw new Error("Unauthorized");
					}
					return response.json();
				})
				.then((data) => {
					if (data.role !== "admin") {
						window.location.href = "/auth/denied";
						return;
					}
					if (shell) shell.classList.remove("is-hidden");
				})
				.catch(() => {});
		</script>
	</body>
</html>

<style>
	:root {
		color-scheme: light;
		--ink: #1f2933;
		--muted: #5b6672;
		--tan: #dbe2ea;
		--ink-soft: #364152;
		--shadow: rgba(13, 30, 48, 0.18);
		--border: rgba(33, 51, 70, 0.14);
		--accent: #3b6ea5;
		--accent-dark: #2a5581;
		--radius: 22px;
		font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
		background: radial-gradient(circle at top right, #f7fbff 0%, #eef2f6 55%, #e2e8f0 100%);
	}

	* {
		box-sizing: border-box;
	}

	body {
		margin: 0;
		color: var(--ink);
		background: linear-gradient(120deg, #f6f9fc 0%, #e9eff6 60%, #dde5ef 100%);
		min-height: 100vh;
	}

	main {
		padding: 2rem 6vw 4rem;
		display: grid;
		gap: 2rem;
	}

	.hero {
		display: grid;
		gap: 0.6rem;
	}

	.eyebrow {
		text-transform: uppercase;
		letter-spacing: 0.22em;
		font-size: 0.72rem;
		color: var(--muted);
		font-weight: 600;
	}

	.card {
		background: rgba(255, 255, 255, 0.78);
		border-radius: var(--radius);
		padding: 1.8rem;
		box-shadow: 0 24px 50px -30px var(--shadow);
		border: 1px solid var(--border);
		display: grid;
		gap: 1rem;
	}

	.section-head {
		display: flex;
		align-items: baseline;
		justify-content: space-between;
		gap: 2rem;
		flex-wrap: wrap;
	}

	.muted {
		color: var(--muted);
		line-height: 1.6;
	}

	.small {
		font-size: 0.9rem;
	}

	.actions {
		display: flex;
		gap: 0.6rem;
		flex-wrap: wrap;
	}

	.chip {
		border-radius: 999px;
		padding: 0.4rem 0.85rem;
		font-size: 0.75rem;
		background: var(--tan);
		font-weight: 500;
	}

	.ghost {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		padding: 0.7rem 1.4rem;
		border-radius: 999px;
		font-weight: 600;
		font-size: 0.9rem;
		border: 1px solid var(--border);
		background: rgba(255, 255, 255, 0.7);
		cursor: pointer;
	}

	.is-hidden {
		display: none;
	}
</style>
